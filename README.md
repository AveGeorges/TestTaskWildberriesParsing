# WB Parser

Парсер каталога Wildberries по поисковому запросу.

## Что делает

- Ищет товары по запросу
- Собирает всю инфу: артикул, название, цена, описание, характеристики, продавец, размеры, остатки, рейтинг
- Сохраняет в Excel
- Фильтрует по рейтингу, цене и стране

## Установка

```bash
python -m venv .venv
.venv\Scripts\activate
pip install -r req.txt

playwright install chromium
```

## Использование

```bash
# Примеры команд:

# 1. С браузером, 10 страниц, запрос "пальто из натуральной шерсти"
python -m src.main -q "пальто из натуральной шерсти" -p 10 --browser

# 2. С браузером, 5 страниц, показывать окно браузера
python -m src.main -q "пальто" -p 5 --browser --show-browser

# 3. Без браузера, 5 страниц (только HTTP-запросы, быстрее, но может блокироваться)
python -m src.main -q "пальто" -p 5

# 4. Только поиск, без дополнительного сбора описания/характеристик, 3 страницы
python -m src.main -q "пальто" -p 3 --no-enrich --browser
```

## Параметры

| Флаг | Описание |
|------|----------|
| `-q` | Поисковый запрос |
| `-p` | Кол-во страниц |
| `-o` | Папка вывода (default: output) |
| `--browser` | Режим Playwright (рекомендуется) |
| `--show-browser` | Показать окно браузера |
| `--no-enrich` | Без описаний/характеристик |
| `--no-cache` | Без кэша |
| `--clear-cache` | Очистить кэш |
| `--min-rating` | Мин. рейтинг для фильтра (4.5) |
| `--max-price` | Макс. цена (10000) |
| `--country` | Страна (Россия) |

## Результат

- `catalog_full_*.xlsx` — все товары
- `catalog_filtered_*.xlsx` — отфильтрованные (рейтинг >= 4.5, цена <= 10000, Россия)

## Как работает

1. Браузерный режим — Playwright эмулирует Chrome, обходит защиту
2. HTTP режим — прямые запросы к API, может получать 429

API:
- `search.wb.ru` — поиск
- `card.wb.ru` — детали товара
- `basket-XX.wbbasket.ru` — карточки, картинки

## Структура

```
src/
├── main.py         — точка входа, CLI
├── wb_browser.py   — парсер через Playwright  
├── wb_parser.py    — парсер через HTTP
├── excel_writer.py — экспорт в xlsx
├── models.py       — модель Product
├── config.py       — настройки
└── cache.py        — файловый кэш
```
